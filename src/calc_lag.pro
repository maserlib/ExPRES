;***********************************************************
;***                                                     ***
;***         SERPE V6.1                                  ***
;***                                                     ***
;***********************************************************
;***                                                     ***
;***       MODULE: calc_lag                              ***
;***        CL : 29/06/2015                              ***
;***     function: calc_lag ; automatic calculation 	 ***
;***    	of the lead angle	 		 ***
;***                                                     ***
;***********************************************************


;# this routine is called by src.prop
function calc_lag,lag_model,north,phase,satellite = satellite
if satellite eq 'Io' then begin
	CASE strlowcase(lag_model) OF
		; # ref Hess et al., 2011, https://doi.org/10.1029/2010JA016262
		'hess2011': BEGIN 
			if north eq 1 then begin
				A=2.8
				B=-3.5
			endif else begin
				A=4.3
				B=3.5
			endelse
		
			lag =-(A+B*cos((phase-202)*!dtor)) 
		END
		
		'bonfond2017_old': BEGIN
			long_io_eq_f=[0.00000,7.50000,15.0000,22.5000,30.0000,37.5000,45.0000,52.5000,60.0000,67.5000,75.0000,82.5000,$
							90.0000,97.5000,105.000,112.500,120.000,127.500,135.000,142.500,150.000,157.500,165.000,172.500,$
							180.000,187.500,195.000,202.500,210.000,217.500,225.000,232.500,240.000,247.500,255.000,262.500,$
							270.000,277.500,285.000,292.500,300.000,307.500,315.000,322.500,330.000,337.500,345.000,352.500]
			if north eq 1 then begin
				LEAD_ANGLE=[8.59204,5.61914,3.79482,3.05602,2.99539,3.27324,3.68649,4.01736,4.17867,4.21087,3.98134,3.35851,$
   							    2.60966,2.13805,2.11762,2.33275,2.37592,2.05157,1.37680,0.614075,0.0312195,-0.261475,-0.268463,-0.143600,$
   								-0.0187683,0.0464020,0.130035,0.390503,0.982330,1.95081,3.22447,4.64015,5.99623,7.15498,8.03447,8.56259,$
   								8.74271,8.67563,8.56934,8.72421,9.39789,10.7338,12.5926,14.6002,16.0847,16.3546,14.9661,12.0841]
			endif else begin
				LEAD_ANGLE =[1.09468,1.39893,1.84181,2.31957,2.72874,2.98216,3.01823,2.84669,2.56770,2.34957,2.28384,2.31649,$
								2.30152,2.08582,1.66994,1.23314,1.01020,1.21442,1.90141,2.92976,4.11429,5.18910,5.96736,6.39481,$
								6.52968,6.51189,6.43202,6.32704,6.22534,6.14983,6.07802,5.91316,5.51376,4.81104,3.84581,2.76746,$
								1.85281,1.29144,1.19702,1.50687,2.03488,2.54117,2.80032,2.68848,2.27142,1.71063,1.24466,1.04129]
			endelse
			lag=-interpol(LEAD_ANGLE,LONG_IO_EQ_F,phase)  
		END
		; # ref Bonfond et al., 2009, https://doi.org/10.1029/2009JA014312.
		'bonfond2009': BEGIN
			long_io_eq_f = [0.00000, 10.0000, 20.0000, 30.0000, 40.0000, 50.0000, 60.0000, 70.0000, 80.0000, 90.0000, 100.000, 110.000, 120.000, $
      						130.000, 140.000, 150.000, 160.000, 70.000, 180.000, 190.000, 200.000, 210.000, 220.000, 230.000, 240.000, 250.000, $
      						260.000, 270.000, 280.000, 290.000, 00.000, 310.000, 320.000, 330.000, 340.000, 350.000]
			if north eq 1 then begin
				LEAD_ANGLE = [5.43109, 8.83282, 8.90802, 8.83027, 8.91931, 7.46500, 3.47471, 3.26332, 4.10609, 3.97320, 2.40401, 0.927452, 0.843895, $
							  0.318832, -0.195953, 1.01109, 1.50520, -0.369354, -1.61499, -1.21384, -0.104828, 0.640854, 1.28864, 2.32701, 2.97781, 4.21843, $
							  7.70917, 10.5366, 10.0954, 6.96402, 4.13486, 2.92114, 2.16888, 1.39453, 0.736420, 1.73755]
			endif else begin
				LEAD_ANGLE = [1.88572, 2.04485, 2.20365, 2.40854, 2.65113, 2.74149, 2.83416, 2.75132, 2.50095, 2.14429, 2.01299, 2.07418, 2.46944, $
 							  3.38979, 4.50525, 5.64671, 6.51059, 6.87531, 7.01347, 7.11342, 7.40739, 7.56808, 7.07001, 6.40158, 5.83038, 5.61137, $
 							  5.34552, 5.16776, 5.00592, 4.58920, 4.15887, 3.54807, 2.95288, 2.41266, 2.00992, 1.76260]
			endelse
			lag=-interpol(LEAD_ANGLE,LONG_IO_EQ_F,phase)
		END
		; # ref Bonfond et al., 2017, http://dx.doi.org/10.1016/j.icarus.2017.01.009
		'bonfond2017': BEGIN
			long_io_eq_f = [0.00000, 1.00000, 2.00000, 3.00000, 4.00000, 5.00000, 6.00000, 7.00000, 8.00000, 9.00000, 10.0000, 11.0000, 12.0000, $
						    13.0000, 14.0000, 15.0000, 16.0000, 17.0000, 18.0000, 19.0000, 20.0000, 21.0000, 22.0000, 23.0000, 24.0000, 25.0000, $
						    26.0000, 27.0000, 28.0000, 29.0000, 30.0000, 31.0000, 32.0000, 33.0000, 34.0000, 35.0000, 36.0000, 37.0000, 38.0000, $
						    39.0000, 40.0000, 41.0000, 42.0000, 43.0000, 44.0000, 45.0000, 46.0000, 47.0000, 48.0000, 49.0000, 50.0000, 51.0000, $
						    52.0000, 53.0000, 54.0000, 55.0000, 56.0000, 57.0000, 58.0000, 59.0000, 60.0000, 61.0000, 62.0000, 63.0000, 64.0000, $
						    65.0000, 66.0000, 67.0000, 68.0000, 69.0000, 70.0000, 71.0000, 72.0000, 73.0000, 74.0000, 75.0000, 76.0000, 77.0000, $
						    78.0000, 79.0000, 80.0000, 81.0000, 82.0000, 83.0000, 84.0000, 85.0000, 86.0000, 87.0000, 88.0000, 89.0000, 90.0000, $
						    91.0000, 92.0000, 93.0000, 94.0000, 95.0000, 96.0000, 97.0000, 98.0000, 99.0000, 100.000, 101.000, 102.000, 103.000, $
						    104.000, 105.000, 106.000, 107.000, 108.000, 109.000, 110.000, 111.000, 112.000, 113.000, 114.000, 115.000, 116.000, $
						    117.000, 118.000, 119.000, 120.000, 121.000, 122.000, 123.000, 124.000, 125.000, 126.000, 127.000, 128.000, 129.000, $
						    130.000, 131.000, 132.000, 133.000, 134.000, 135.000, 136.000, 137.000, 138.000, 139.000, 140.000, 141.000, 142.000, $
						    143.000, 144.000, 145.000, 146.000, 147.000, 148.000, 149.000, 150.000, 151.000, 152.000, 153.000, 154.000, 155.000, $
						    156.000, 157.000, 158.000, 159.000, 160.000, 161.000, 162.000, 163.000, 164.000, 165.000, 166.000, 167.000, 168.000, $
						    169.000, 170.000, 171.000, 172.000, 173.000, 174.000, 175.000, 176.000, 177.000, 178.000, 179.000, 180.000, 181.000, $
						    182.000, 183.000, 184.000, 185.000, 186.000, 187.000, 188.000, 189.000, 190.000, 191.000, 192.000, 193.000, 194.000, $
						    195.000, 196.000, 197.000, 198.000, 199.000, 200.000, 201.000, 202.000, 203.000, 204.000, 205.000, 206.000, 207.000, $
						    208.000, 209.000, 210.000, 211.000, 212.000, 213.000, 214.000, 215.000, 216.000, 217.000, 218.000, 219.000, 220.000, $
						    221.000, 222.000, 223.000, 224.000, 225.000, 226.000, 227.000, 228.000, 229.000, 230.000, 231.000, 232.000, 233.000, $
						    234.000, 235.000, 236.000, 237.000, 238.000, 239.000, 240.000, 241.000, 242.000, 243.000, 244.000, 245.000, 246.000, $
						    247.000, 248.000, 249.000, 250.000, 251.000, 252.000, 253.000, 254.000, 255.000, 256.000, 257.000, 258.000, 259.000, $
						    260.000, 261.000, 262.000, 263.000, 264.000, 265.000, 266.000, 267.000, 268.000, 269.000, 270.000, 271.000, 272.000, $
						    273.000, 274.000, 275.000, 276.000, 277.000, 278.000, 279.000, 280.000, 281.000, 282.000, 283.000, 284.000, 285.000, $
						    286.000, 287.000, 288.000, 289.000, 290.000, 291.000, 292.000, 293.000, 294.000, 295.000, 296.000, 297.000, 298.000, $
						    299.000, 300.000, 301.000, 302.000, 303.000, 304.000, 305.000, 306.000, 307.000, 308.000, 309.000, 310.000, 311.000, $
						    312.000, 313.000, 314.000, 315.000, 316.000, 317.000, 318.000, 319.000, 320.000, 321.000, 322.000, 323.000, 324.000, $
						    325.000, 326.000, 327.000, 328.000, 329.000, 330.000, 331.000, 332.000, 333.000, 334.000, 335.000, 336.000, 337.000, $
						    338.000, 339.000, 340.000, 341.000, 342.000, 343.000, 344.000, 345.000, 346.000, 347.000, 348.000, 349.000, 350.000, $
						    351.000, 352.000, 353.000, 354.000, 355.000, 356.000, 357.000, 358.000, 359.000]
		
			if north eq 1 then begin
				LEAD_ANGLE = [8.85156,   8.40613,   7.97241,   7.55276,   7.14944,   6.75827,   6.39261,   6.04233,   5.71933,   5.40869,   5.12616,   4.86206,   4.62112, $
							  4.39880,   4.19882,   4.01663,   3.85533,   3.71035,   3.58425,   3.47255,   3.37733,   3.29449,   3.22807,   3.16938,   3.12436,   3.08750, $
							  3.05990,   3.04042,   3.02831,   3.02255,   3.02275,   3.02817,   3.03872,   3.05330,   3.07202,   3.09393,   3.11966,   3.14712,   3.17687, $
							  3.20890,   3.24313,   3.27550,   3.31057,   3.34421,   3.37526,   3.40560,   3.43399,   3.45753,   3.47832,   3.49588,   3.50984,   3.52005, $
							  3.52192,   3.52387,   3.51696,   3.51080,   3.49586,   3.48236,   3.46568,   3.44032,   3.41813,   3.39344,   3.36637,   3.32980,   3.29773, $
							  3.26284,   3.23357,   3.19283,   3.14887,   3.10063,   3.04864,   2.99168,   2.92994,   2.86416,   2.79307,   2.71770,   2.62685,   2.54328, $
							  2.44506,   2.34402,   2.24065,   2.13687,   2.03411,   1.91886,   1.81949,   1.70938,   1.60495,   1.49185,   1.39973,   1.30043,   1.22434, $
							  1.14249,   1.07068,   1.00895,  0.958618,   0.903320,  0.874420,  0.855560,  0.832588,  0.819328,  0.831406,  0.837746,  0.852226,  0.873657, $
							  0.903954,  0.955521,  0.997665,   1.02538,  1.07342,   1.12444,   1.17863,   1.23088,   1.26710,   1.31908,   1.36924,   1.39810,   1.44127, $
							  1.46320,   1.48015,   1.50980,   1.51499,   1.51339,   1.50546,   1.49139,   1.48677,   1.45872,   1.42304,   1.38203,   1.33391,   1.27671, $
							  1.21700,   1.14873,   1.09293,   1.01433,   0.931976,  0.860092,  0.786667,  0.694122,  0.614166,  0.530869,  0.446838,  0.376785,  0.291046, $
							  0.219009,  0.148254,  0.0788727, 0.0108490,-0.0447845,-0.107849, -0.158813, -0.206787, -0.239258, -0.280869, -0.309738, -0.333664, -0.354706, $
							 -0.364563, -0.369949, -0.382660, -0.382904, -0.371552, -0.364792, -0.351425, -0.341705, -0.321686, -0.301407, -0.273788, -0.251266, -0.228287, $
							 -0.198807, -0.169296, -0.141663, -0.111862,  -0.0858459, -0.0592804,-0.0341644,-0.00822449,0.0178833, 0.0393524, 0.0628204, 0.0805206, 0.0999146, $
							  0.116562,  0.132629,  0.148270,  0.162552,  0.175995,  0.187378,  0.201111,  0.213501,  0.225266,  0.239273,  0.255508,  0.271683,  0.289658, $
							  0.311279,  0.337006,  0.363113,  0.395508,  0.430496,  0.469971,  0.518097,  0.567337,  0.625839,  0.685059,  0.754349,  0.830841,  0.913071, $
							  0.996780,  1.08997,   1.19228,   1.29861,   1.41393,   1.53339,   1.66725,   1.80000,   1.93993,   2.08549,   2.23512,   2.39186,   2.55415, $
							  2.72041,   2.88184,   3.05728,   3.23799,   3.42117,   3.59718,   3.77800,   3.97067,   4.15424,   4.34111,   4.52859,   4.71663,   4.90529, $
							  5.08247,   5.27097,   5.44653,   5.63232,   5.80640,   5.97726,   6.15652,   6.32155,   6.48376,   6.64212,   6.79572,   6.94586,   7.09048, $
							  7.22986,   7.36420,   7.49278,   7.61574,   7.73259,   7.84230,   7.94649,   8.05617,   8.14705,   8.24339,   8.31955,   8.40292,   8.46571, $
							  8.53470,   8.59700,   8.63867,   8.68762,   8.73091,   8.76697,   8.79709,   8.80792,   8.82611,   8.83926,   8.84760,   8.85147,   8.85031, $
							  8.84534,   8.82306,   8.81113,   8.79761,   8.78198,   8.76447,   8.74738,   8.72937,   8.71329,   8.69836,   8.68665,   8.67804,   8.67407, $
							  8.66122,   8.66800,   8.68179,   8.70276,   8.73282,   8.75809,   8.80600,   8.85141,   8.90784,   8.97620,   9.05576,   9.14798,   9.25201, $
							  9.36932,   9.49945,   9.62967,   9.78546,   9.94125,   10.1227,   10.3031,   10.4962,   10.7009,   10.9289,   11.1546,   11.3901,   11.6342, $
							  11.8863,   12.1450,   12.4095,   12.6783,   12.9502,   13.2240,   13.4980,   13.7710,   14.0410,   14.3068,   14.5664,   14.8185,   15.0608, $
							  15.2921,   15.5100,   15.7021,   15.8889,   16.0576,   16.2061,   16.3329,   16.4255,   16.5044,   16.5570,   16.5821,   16.5783,   16.5446, $
							  16.4803,   16.3843,   16.2563,   16.0960,   15.9034,   15.6882,   15.4412,   15.1630,   14.8546,   14.5267,   14.1716,   13.7910,   13.3872, $
							  12.9714,   12.5373,   12.0880,   11.6345,   11.1716,   10.7027,   10.2310,   9.76697,   9.30612]

			endif else begin
				LEAD_ANGLE = [1.25577, 1.28125, 1.31568, 1.34826, 1.38919, 1.42808, 1.47462, 1.51917, 1.57049, 1.62381, 1.67484, 1.73164, 1.78963,$ 
							  1.84517, 1.90517, 1.96578, 2.02668, 2.08476, 2.14564, 2.20363, 2.26361, 2.32049, 2.37858, 2.43343, 2.48864, 2.54048,$
							  2.59063, 2.63876, 2.68564, 2.72902, 2.76976, 2.80773, 2.84273, 2.87470, 2.90344, 2.92872, 2.95040, 2.96847, 2.98273,$
							  2.99322, 2.99988, 3.00269, 3.00373, 2.99923, 2.98859, 2.97694, 2.96182, 2.94376, 2.92285, 2.89564, 2.86988, 2.83815,$
							  2.80886, 2.77399, 2.73798, 2.70665, 2.67013, 2.63400, 2.59856, 2.56443, 2.52518, 2.49446, 2.46612, 2.44054, 2.41018,$
							  2.39071, 2.36634, 2.35347, 2.33561, 2.32101, 2.31892, 2.31078, 2.30556, 2.31335, 2.31389, 2.31648, 2.33219, 2.33874,$
							  2.34651, 2.35514, 2.36411, 2.37312, 2.39417, 2.40207, 2.40857, 2.41335, 2.41611, 2.41633, 2.41369, 2.40810, 2.39926,$
							  2.38689, 2.37090, 2.35116, 2.32784, 2.28522, 2.25452, 2.22042, 2.18312, 2.12664, 2.08369, 2.03873, 1.97524, 1.92720,$
							  1.86142, 1.79520, 1.74671, 1.68164, 1.61826, 1.55694, 1.49848, 1.44360, 1.39296, 1.34716, 1.30668, 1.25430, 1.22649,$
							  1.20576, 1.17471, 1.16955, 1.15503, 1.14879, 1.15315, 1.18326, 1.20492, 1.23704, 1.27831, 1.32856, 1.38902, 1.44226,$
							  1.52136, 1.60893, 1.70589, 1.79439, 1.90858, 2.01308, 2.14043, 2.26022, 2.40105, 2.53114, 2.66728, 2.82350, 2.96806,$
							  3.11626, 3.28157, 3.43451, 3.58888, 3.74368, 3.91269, 4.06715, 4.22115, 4.37283, 4.53523, 4.68153, 4.82414, 4.96321,$
							  5.09807, 5.23886, 5.36234, 5.48071, 5.60352, 5.70915, 5.81863, 5.90991, 6.00465, 6.08200, 6.16248, 6.23462, 6.29982,$
							  6.35716, 6.40808, 6.45244, 6.48947, 6.52057, 6.55315, 6.57259, 6.59332, 6.60857, 6.61940, 6.62569, 6.62842, 6.62726,$
							  6.62309, 6.61983, 6.61078, 6.60258, 6.58900, 6.57704, 6.56305, 6.54785, 6.53136, 6.51408, 6.49643, 6.47757, 6.45853,$
							  6.43932, 6.41960, 6.39996, 6.37939, 6.36023, 6.33966, 6.31990, 6.29997, 6.28062, 6.26207, 6.24464, 6.22470, 6.20924,$
							  6.19508, 6.17854, 6.16292, 6.15384, 6.14095, 6.12978, 6.12019, 6.11276, 6.10605, 6.10147, 6.09837, 6.08923, 6.08855,$
							  6.08105, 6.08214, 6.07568, 6.06863, 6.07028, 6.06302, 6.05386, 6.04448, 6.02304, 6.00958, 5.99301, 5.96391, 5.94118,$
							  5.90526, 5.87506, 5.83026, 5.78134, 5.73784, 5.67914, 5.61549, 5.54617, 5.47066, 5.39079, 5.30511, 5.21461, 5.11790,$
							  5.01668, 4.89806, 4.78673, 4.67154, 4.55078, 4.42734, 4.29961, 4.16847, 4.03519, 3.89877, 3.76112, 3.62157, 3.48091,$
							  3.33984, 3.21234, 3.07172, 2.94592, 2.80804, 2.68607, 2.55304, 2.43698, 2.32477, 2.21667, 2.11343, 2.01529, 1.92282,$
							  1.83621, 1.75598, 1.68253, 1.62958, 1.57004, 1.51788, 1.48676, 1.44952, 1.43344, 1.42477, 1.40979, 1.41580, 1.42874,$
							  1.44849, 1.47473, 1.50729, 1.53217, 1.57593, 1.62457, 1.67776, 1.74792, 1.80853, 1.87213, 1.93793, 2.00562, 2.07443,$
							  2.14395, 2.22610, 2.29495, 2.36273, 2.42886, 2.49271, 2.56616, 2.62396, 2.67804, 2.72809, 2.77350, 2.82584, 2.86105,$
							  2.89069, 2.91455, 2.93253, 2.94440, 2.95004, 2.94943, 2.94269, 2.92981, 2.91086, 2.88611, 2.85556, 2.81967, 2.76834,$
							  2.72269, 2.67264, 2.60855, 2.55109, 2.48062, 2.41766, 2.34286, 2.27625, 2.19916, 2.12177, 2.05365, 1.97687, 1.90115,$
							  1.83578, 1.76373, 1.69406, 1.63550, 1.57162, 1.51129, 1.46255, 1.40997, 1.36157, 1.32516, 1.29303, 1.25821, 1.23520,$
							  1.21680, 1.19638, 1.18744, 1.18307, 1.18338, 1.18814, 1.19733, 1.21085, 1.23416]
			endelse
			lag=-interpol(LEAD_ANGLE,LONG_IO_EQ_F,phase)
		END
		; # ref Hinton et al., 2019, https://doi.org/10.1029/2018GL081472
		'hinton2019': BEGIN
			long_io_eq_f = [1.00000, 2.00000, 3.00000, 4.00000, 5.00000, 6.00000, 7.00000, 8.00000, 9.00000, 10.0000, 11.0000, 12.0000, 13.0000, $
						    14.0000, 15.0000, 16.0000, 17.0000, 18.0000, 19.0000, 20.0000, 21.0000, 22.0000, 23.0000, 24.0000, 25.0000, 26.0000, $
						    27.0000, 28.0000, 29.0000, 30.0000, 31.0000, 32.0000, 33.0000, 34.0000, 35.0000, 36.0000, 37.0000, 38.0000, 39.0000, $
						    40.0000, 41.0000, 42.0000, 43.0000, 44.0000, 45.0000, 46.0000, 47.0000, 48.0000, 49.0000, 50.0000, 51.0000, 52.0000, $
						    53.0000, 54.0000, 55.0000, 56.0000, 57.0000, 58.0000, 59.0000, 60.0000, 61.0000, 62.0000, 63.0000, 64.0000, 65.0000, $
						    66.0000, 67.0000, 68.0000, 69.0000, 70.0000, 71.0000, 72.0000, 73.0000, 74.0000, 75.0000, 76.0000, 77.0000, 78.0000, $
						    79.0000, 80.0000, 81.0000, 82.0000, 83.0000, 84.0000, 85.0000, 86.0000, 87.0000, 88.0000, 89.0000, 90.0000, 91.0000, $
						    92.0000, 93.0000, 94.0000, 95.0000, 96.0000, 97.0000, 98.0000, 99.0000, 100.000, 101.000, 102.000, 103.000, 104.000, $
						    105.000, 106.000, 107.000, 108.000, 109.000, 110.000, 111.000, 112.000, 113.000, 114.000, 115.000, 116.000, 117.000, $
						    118.000, 119.000, 120.000, 121.000, 122.000, 123.000, 124.000, 125.000, 126.000, 127.000, 128.000, 129.000, 130.000, $
						    131.000, 132.000, 133.000, 134.000, 135.000, 136.000, 137.000, 138.000, 139.000, 140.000, 141.000, 142.000, 143.000, $
						    144.000, 145.000, 146.000, 147.000, 148.000, 149.000, 150.000, 151.000, 152.000, 153.000, 154.000, 155.000, 156.000, $
						    157.000, 158.000, 159.000, 160.000, 161.000, 162.000, 163.000, 164.000, 165.000, 166.000, 167.000, 168.000, 169.000, $
						    170.000, 171.000, 172.000, 173.000, 174.000, 175.000, 176.000, 177.000, 178.000, 179.000, 180.000, 181.000, 182.000, $
						    183.000, 184.000, 185.000, 186.000, 187.000, 188.000, 189.000, 190.000, 191.000, 192.000, 193.000, 194.000, 195.000, $
						    196.000, 197.000, 198.000, 199.000, 200.000, 201.000, 202.000, 203.000, 204.000, 205.000, 206.000, 207.000, 208.000, $
						    209.000, 210.000, 211.000, 212.000, 213.000, 214.000, 215.000, 216.000, 217.000, 218.000, 219.000, 220.000, 221.000, $
						    222.000, 223.000, 224.000, 225.000, 226.000, 227.000, 228.000, 229.000, 230.000, 231.000, 232.000, 233.000, 234.000, $
						    235.000, 236.000, 237.000, 238.000, 239.000, 240.000, 241.000, 242.000, 243.000, 244.000, 245.000, 246.000, 247.000, $
						    248.000, 249.000, 250.000, 251.000, 252.000, 253.000, 254.000, 255.000, 256.000, 257.000, 258.000, 259.000, 260.000, $
						    261.000, 262.000, 263.000, 264.000, 265.000, 266.000, 267.000, 268.000, 269.000, 270.000, 271.000, 272.000, 273.000, $
						    274.000, 275.000, 276.000, 277.000, 278.000, 279.000, 280.000, 281.000, 282.000, 283.000, 284.000, 285.000, 286.000, $
						    287.000, 288.000, 289.000, 290.000, 291.000, 292.000, 293.000, 294.000, 295.000, 296.000, 297.000, 298.000, 299.000, $
						    300.000, 301.000, 302.000, 303.000, 304.000, 305.000, 306.000, 307.000, 308.000, 309.000, 310.000, 311.000, 312.000, $
						    313.000, 314.000, 315.000, 316.000, 317.000, 318.000, 319.000, 320.000, 321.000, 322.000, 323.000, 324.000, 325.000, $
						    326.000, 327.000, 328.000, 329.000, 330.000, 331.000, 332.000, 333.000, 334.000, 335.000, 336.000, 337.000, 338.000, $
						    339.000, 340.000, 341.000, 342.000, 343.000, 344.000, 345.000, 346.000, 347.000, 348.000, 349.000, 350.000, 351.000, $
						    352.000, 353.000, 354.000, 355.000, 356.000, 357.000, 358.000, 359.000, 360.000]

			if north eq 1 then begin
				LEAD_ANGLE = [5.04431, 5.02976, 5.00072, 4.96021, 4.94201, 4.89824, 4.87737, 4.82087, 4.77476, 4.71959, 4.67666, 4.64602, 4.62555, $
							  4.56982, 4.54191, 4.52501, 4.50528, 4.48861, 4.46576, 4.44932, 4.43774, 4.43401, 4.44486, 4.46058, 4.48392, 4.51646, $
							  4.55973, 4.60854, 4.67361, 4.74515, 4.81857, 4.89796, 4.96598, 5.02353, 5.09351, 5.18436, 5.26075, 5.30875, 5.34671, $
							  5.35517, 5.37634, 5.38568, 5.41060, 5.43670, 5.44304, 5.40178, 5.39331, 5.37849, 5.37781, 5.33933, 5.31758, 5.25766, $
							  5.14737, 5.02963, 4.91300, 4.74513, 4.62150, 4.44242, 4.25215, 4.08799, 3.89302, 3.75579, 3.63656, 3.51764, 3.35542, $
							  3.16281, 3.03322, 2.96946, 2.86897, 2.84234, 2.71135, 2.53937, 2.42933, 2.39225, 2.31603, 2.33506, 2.30430, 2.27689, $
							  2.18514, 2.15498, 2.22175, 2.24645, 2.24749, 2.24849, 2.21844, 2.23127, 2.20744, 2.20398, 2.26044, 2.26121, 2.26965, $
							  2.25154, 2.31987, 2.27827, 2.25708, 2.29400, 2.31212, 2.34226, 2.30807, 2.27877, 2.31802, 2.26840, 2.28082, 2.23829, $
							  2.22703, 2.22323, 2.16622, 2.17766, 2.20551, 2.18885, 2.20913, 2.24058, 2.23158, 2.20361, 2.17522, 2.13683, 2.10712, $
							  2.04797, 2.00441, 1.97051, 1.92188, 1.89689, 1.84385, 1.84483, 1.85797, 1.82571, 1.82608, 1.82332, 1.81648, 1.78708, $
							  1.78632, 1.76486, 1.70882, 1.68369, 1.66404, 1.62152, 1.58620, 1.55071, 1.52281, 1.47250, 1.46718, 1.46325, 1.44131, $
							  1.41363, 1.41857, 1.41661, 1.42047, 1.40226, 1.41232, 1.38912, 1.39589, 1.37098, 1.37232, 1.35307, 1.34567, 1.33730, $
							  1.33344, 1.32756, 1.33482, 1.31700, 1.32348, 1.32564, 1.32150, 1.32424, 1.31976, 1.33106, 1.32546, 1.32098, 1.32881, $
							  1.33840, 1.34112, 1.36359, 1.36091, 1.35549, 1.35573, 1.37569, 1.39240, 1.40805, 1.42013, 1.42936, 1.43346, 1.45373, $
							  1.46893, 1.47961, 1.49421, 1.50212, 1.50384, 1.49704, 1.50817, 1.51145, 1.50706, 1.52289, 1.51677, 1.50691, 1.49030, $
							  1.49220, 1.51269, 1.52784, 1.53518, 1.55129, 1.56272, 1.57766, 1.60221, 1.64747, 1.65729, 1.65025, 1.63930, 1.64656, $
							  1.66033, 1.65377, 1.68780, 1.70291, 1.70006, 1.72231, 1.74623, 1.74865, 1.76581, 1.77784, 1.78258, 1.79727, 1.79220, $
							  1.79385, 1.78977, 1.78683, 1.82334, 1.82402, 1.83422, 1.87683, 1.91456, 1.94727, 1.99226, 2.01514, 2.06468, 2.07719, $
							  2.10216, 2.12870, 2.16098, 2.15967, 2.16874, 2.18008, 2.23560, 2.23941, 2.23909, 2.26758, 2.30933, 2.30039, 2.32625, $
							  2.38171, 2.40862, 2.42654, 2.48913, 2.55064, 2.60010, 2.64277, 2.67923, 2.70587, 2.73531, 2.74765, 2.76723, 2.77626, $
							  2.81745, 2.82915, 2.83103, 2.88290, 2.92522, 2.95874, 3.03636, 3.11046, 3.13815, 3.17613, 3.24880, 3.31775, 3.38528, $
							  3.42524, 3.45918, 3.49764, 3.52609, 3.60807, 3.64199, 3.66863, 3.66725, 3.68275, 3.74396, 3.80430, 3.82601, 3.85850, $
							  3.87949, 3.90149, 3.97715, 4.03214, 4.08092, 4.11817, 4.15161, 4.18648, 4.22066, 4.27272, 4.34918, 4.34182, 4.39297, $
							  4.43805, 4.42979, 4.43878, 4.48394, 4.53406, 4.52210, 4.52572, 4.56709, 4.61137, 4.59526, 4.63767, 4.67172, 4.70705, $
							  4.70344, 4.74088, 4.77040, 4.80259, 4.81677, 4.84833, 4.87407, 4.90159, 4.91444, 4.92360, 4.98380, 5.00891, 5.03320, $
							  5.05542, 5.11387, 5.13578, 5.15990, 5.18170, 5.23646, 5.25908, 5.27920, 5.28102, 5.29440, 5.31399, 5.37589, 5.37550, $
							  5.39479, 5.41504, 5.41893, 5.43817, 5.46078, 5.44335, 5.46850, 5.44546, 5.47097, 5.46871, 5.46004, 5.41924, 5.41531, $
							  5.42134, 5.42924, 5.39970, 5.35880, 5.35761, 5.36661, 5.37142, 5.40625, 5.41450]

			endif else begin
				LEAD_ANGLE = [1.74549, 1.73421, 1.72215, 1.69916, 1.67600, 1.65231, 1.63939, 1.62570, 1.63446, 1.62124, 1.59614, 1.57122, 1.56809, $
							  1.56450, 1.56102, 1.54561, 1.53091, 1.50403, 1.49917, 1.49481, 1.49022, 1.47366, 1.45660, 1.45202, 1.44707, 1.44110, $
							  1.44596, 1.45017, 1.45621, 1.46193, 1.46754, 1.47323, 1.46561, 1.45755, 1.45395, 1.45073, 1.44807, 1.44267, 1.42675, $
							  1.41171, 1.39688, 1.38300, 1.37068, 1.35465, 1.33930, 1.33650, 1.33497, 1.34531, 1.35643, 1.35860, 1.36192, 1.38379, $
							  1.40780, 1.42222, 1.42590, 1.43046, 1.44426, 1.45902, 1.47285, 1.48520, 1.50229, 1.50716, 1.52296, 1.54848, 1.57404, $
							  1.58060, 1.60736, 1.63576, 1.66355, 1.68142, 1.69963, 1.73696, 1.75325, 1.77082, 1.81036, 1.81826, 1.85356, 1.88529, $
							  1.90961, 1.93949, 1.96584, 1.99645, 2.03596, 2.05085, 2.08519, 2.11185, 2.13834, 2.18108, 2.22463, 2.24402, 2.29090, $
							  2.33047, 2.36489, 2.40569, 2.44372, 2.50209, 2.53151, 2.57941, 2.63691, 2.66223, 2.69551, 2.74722, 2.78867, 2.82073, $
							  2.85035, 2.89902, 2.94332, 2.98458, 3.04840, 3.09681, 3.15542, 3.21543, 3.26027, 3.30090, 3.33325, 3.37785, 3.42062, $
							  3.44005, 3.47253, 3.49628, 3.53564, 3.58105, 3.61224, 3.66070, 3.68871, 3.70561, 3.75554, 3.78506, 3.81271, 3.83669, $
							  3.86094, 3.88650, 3.91675, 3.93365, 3.95867, 3.98741, 4.02397, 4.04833, 4.07957, 4.11754, 4.14704, 4.17250, 4.19846, $
							  4.23130, 4.26137, 4.28153, 4.33546, 4.36641, 4.39134, 4.45167, 4.48771, 4.52440, 4.56409, 4.59993, 4.63916, 4.65491, $
							  4.67254, 4.72405, 4.75094, 4.76844, 4.79635, 4.84540, 4.87535, 4.91586, 4.94751, 4.97605, 4.98322, 5.01200, 5.05652, $
							  5.10426, 5.11099, 5.12226, 5.13108, 5.17147, 5.21695, 5.25801, 5.29027, 5.29536, 5.29765, 5.31705, 5.35564, 5.39591, $
							  5.41329, 5.42519, 5.41591, 5.40627, 5.41956, 5.43184, 5.44250, 5.43040, 5.41790, 5.40658, 5.39358, 5.42458, 5.44315, $
							  5.45863, 5.46943, 5.48617, 5.49607, 5.51047, 5.51578, 5.52512, 5.51645, 5.46983, 5.42722, 5.38917, 5.34462, 5.30495, $
							  5.25678, 5.21420, 5.18405, 5.17223, 5.19213, 5.18821, 5.19766, 5.19771, 5.18729, 5.19107, 5.18572, 5.17304, 5.11733, $
							  5.07581, 5.04212, 5.03122, 5.02129, 5.00527, 4.98212, 4.97747, 4.93620, 4.91814, 4.89718, 4.90879, 4.88457, 4.84078, $
							  4.81579, 4.80436, 4.77019, 4.75187, 4.73194, 4.72259, 4.69562, 4.64293, 4.63430, 4.62423, 4.56992, 4.53256, 4.52060, $
							  4.50904, 4.45823, 4.40790, 4.39624, 4.37037, 4.33073, 4.32520, 4.32018, 4.30277, 4.26763, 4.25119, 4.24754, 4.23171, $
							  4.19230, 4.18103, 4.16667, 4.15399, 4.11623, 4.11029, 4.10569, 4.07148, 4.03280, 4.03359, 4.02168, 3.98271, 3.93966, $
							  3.93323, 3.89264, 3.85994, 3.85293, 3.82839, 3.79685, 3.76655, 3.76178, 3.72687, 3.67887, 3.65809, 3.63945, 3.59086, $
							  3.57308, 3.52638, 3.48640, 3.44393, 3.41452, 3.38164, 3.33617, 3.29466, 3.27459, 3.22494, 3.19266, 3.16148, 3.12616, $
							  3.10846, 3.06963, 3.03346, 3.00149, 2.95125, 2.92039, 2.90427, 2.85295, 2.80477, 2.77048, 2.73790, 2.70782, 2.67659, $
							  2.64127, 2.61772, 2.56891, 2.55737, 2.52588, 2.49397, 2.48714, 2.45812, 2.43041, 2.41408, 2.39946, 2.37471, 2.33379, $
							  2.32719, 2.29954, 2.28206, 2.26068, 2.22681, 2.21531, 2.18108, 2.17739, 2.17971, 2.14819, 2.13461, 2.09915, 2.10252, $
							  2.10331, 2.07107, 2.06104, 2.04128, 2.00928, 2.00866, 1.99980, 1.97813, 1.95551, 1.93508, 1.92446, 1.91201, 1.90052, $
							  1.87748, 1.84405, 1.82026, 1.82071, 1.79751, 1.77424, 1.76230, 1.73985, 1.71787]
			endelse
			lag=-interpol(LEAD_ANGLE,LONG_IO_EQ_F,phase)
		END
		'hue2023': BEGIN
		; # based on Juno/UVS images - doi to be added once paper is published
		; 2nd Order Fourier Series
			if north eq 1 then begin
				lag = 4.256 + 2.637 * cos(1.000 * phase*!Dtor) + 0.496 * sin(1.000 * phase*!Dtor) + 0.197 * cos(2.* 1.000 * phase*!Dtor) + 0.126 * sin(2.* 1.000 * phase*!Dtor)
			endif else begin
				lag =  4.138 - 1.891 * cos(1.002 * phase*!Dtor) - 0.698 * sin(1.002 * phase*!Dtor) + 0.218 * cos(2.* 1.002 * phase*!Dtor) - 0.116 * sin(2.* 1.002 * phase*!Dtor)
			endelse
			lag = -lag
		END
	ENDCASE
	
endif else if satellite eq 'Ganymede' then begin
	if lag_model eq 'hue2023' then begin
	; # based on Juno/UVS images - doi to be added once paper is published
	; 1st Order Fourier Series
		if north eq 1 then begin
			lag =  12.452 + 6.162 * cos(0.980 * phase*!Dtor) + 3.641 * sin(0.980 * phase*!Dtor)
		endif else begin
			lag =  12.973 - 5.391 * cos(0.996 * phase*!Dtor) - 4.502 * sin(0.996 * phase*!Dtor)
		endelse
		lag = -lag
	endif else begin
		if north eq 1 then begin
			A=6.8
			B=-6.2
		endif else begin
			A=6.8
			B=6.2
		endelse
		lag =-(A+B*cos((phase-202)*!dtor))
	endelse
endif else if satellite eq 'Europa' then begin
	if lag_model eq 'hue2023' then begin
	; # based on Juno/UVS images - doi to be added once paper is published
	; 1st Order Fourier Series
		if north eq 1 then begin
			lag =  5.784 + 3.294 * cos(0.997 * phase*!Dtor) + 1.406 * sin(0.997 * phase*!Dtor) 
		endif else begin
			lag =  7.059 - 3.370 * cos(1.002 * phase*!Dtor) + 0.151 * sin(1.002 * phase*!Dtor)
		endelse
		lag = -lag
	endif else begin
		if north eq 1 then begin
			A=5.2
			B=-4.8
		endif else begin
			A=5.2
			B=4.8
		endelse
		lag =-(A+B*cos((phase-202)*!dtor))
	endelse
endif else if satellite eq 'Callisto' then begin
	lag=0.
endif else lag=0.

return, lag
end
